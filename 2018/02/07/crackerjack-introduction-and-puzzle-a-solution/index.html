<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width initial-scale=1">

    <title>Crackerjack - Introduction and Puzzle A Solution - Jack McPherson</title>
    <meta name="description" content="As part of my journey into reverse engineering, I decided to create my own set of crackmes called Crackerjack. I will be doing a series of articles detailing...">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="https://jmcph4.github.io/css/main.css" type="text/css" />
    <link rel="canonical" href="https://jmcph4.github.io/2018/02/07/crackerjack-introduction-and-puzzle-a-solution/">
    <link rel="alternate" type="application/atom+xml" title="Jack McPherson" href="https://jmcph4.github.io/feed.xml" />
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css'>
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <!-- Google Analytics -->
    <script>
    window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
    ga('create', 'UA-112752433-1', 'auto');
    ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
</head>


  <body lang="en">

    <header>
    <div id="masthead">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <h1>
                        Jack McPherson
                    </h1>
                </div>
            </div>
        </div>
    </div>
  
    <div id="main-menu" class="navbar">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <nav class="nav">
                        <ul class="nav navbar-nav">
                            <li><a href="https://jmcph4.github.io">Home</a><li>
                            <li><a href="https://jmcph4.github.io/posts">Posts</a></li>
                            <li><a href="https://github.com/jmcph4?tab=repositories" target="_blank">Projects</a><li>
                            <li><a href="https://github.com/jmcph4" target="_blank">GitHub</a></li>
                            <li><a href="https://stackoverflow.com/users/story/8028639">Stack Overflow</a></li>
                            <li><a href="https://reddit.com/u/jmcph4">Reddit</a></li>
                            <li><a href="https://www.linkedin.com/in/jack-mcpherson-410b2a134" target="_blank">LinkedIn</a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</header>
<hr>


	<div class="container">
    <div class="page-content">
      <div class="row">
        <div class="col-xs-12">
          <article class="post">

  <header class="post-header">
    <h1 class="post-title">Crackerjack - Introduction and Puzzle A Solution</h1>
    <p class="post-meta">Feb 7, 2018</p>
  </header>
  
    <section id="s1">
<h2>Introduction</h2>
<p>As part of my journey into reverse engineering, I decided to create my own set of <a href="https://en.wikipedia.org/wiki/Crackme" target="_blank" title="Crackme - Wikipedia">"crackmes"</a> called <a href="https://github.com/jmcph4/crackerjack" target="_blank" title="GitHub - jmcph4/crackerjack: A collection of crackmes">Crackerjack</a>. I will be doing a series of articles detailing solutions to each puzzle, predominantly using radare2 and Unix utilities.</p>

<p>While Crackerjack is still a work in progress, each puzzle is standalone. Thus, once one is committed, it means it is ready to be solved. Each puzzle in Crackerjack accepts some arbitrary input on <code>stdin</code>, compares it against the passphrase for that puzzle, and outputs either <kbd>PASS</kbd> or <kbd>FAIL</kbd>. The aim of the game is to determine each passphrase (yes, I know them all, and you can too if you study the source code). In this post, I will walkthrough the solution of the first puzzle, Puzzle A. Be warned, it is <i>very</i> easy (at least when it comes to crackmes).</p>

<p>To acquire the binaries, get a local copy of the Git repository, compile, and strip the binaries:</p>

<pre>
$ git clone https://github.com/jmcph4/crackerjack.git
$ cd crackerjack
$ make
$ strip bin/*
</pre>
</section>

<section id="s2">
<h2>Puzzle A</h2>
<p>The first puzzle is in <code>bin/a</code>. When I first start reverse engineering a program, I like to use it myself for a bit in order to get some intuition as to how the program works. Try running the puzzle binary and trying some different passphrases (who knows, you might get lucky).</p>

As mentioned above, due to this puzzle being the first in the collection it is not meant to be difficult (and is quite the opposite). With this in mind, we can expect to be exploiting some rather low-hanging fruit. Open the puzzle binary in radare2 and use the <kbd>iz</kbd> command to display a list of all ASCII strings radare2 could find in the binary:</p>

<pre>
$ r2 bin/a
[0x00000630]> iz
vaddr=0x00000847 paddr=0x00000847 ordinal=000 sz=7 len=6 section=.rodata type=ascii string=trance
vaddr=0x0000084e paddr=0x0000084e ordinal=001 sz=5 len=4 section=.rodata type=ascii string=PASS
vaddr=0x00000853 paddr=0x00000853 ordinal=002 sz=5 len=4 section=.rodata type=ascii string=FAIL
</pre>

<p>Of course, your output will differ slightly from mine (e.g. the PID used, etc.); however, the key aspects remain the same. Our listing contains three different strings:</p>

<p>
<ol>
    <li><kbd>trance</kbd></li>
    <li><kbd>PASS</kbd></li>
    <li><kbd>FAIL</kbd></li>
</ol>
</p>

<p>Well, we know that every puzzle in Crackerjack outputs either <kbd>PASS</kbd> or <kbd>FAIL</kbd> depending on our passphrase, so the last two strings are easily accounted for. The first string, <kbd>trance</kbd>, looks very out of place. If we attempt this as our passphrase:</p>

<pre>
$ ./bin/a
trance
PASS
</pre>

<p>Success! We have successfully solved the first puzzle binary, using <i>very</i> simple techniques.</p>

<p>We used radare2 to display all of the ASCII strings contained within the puzzle binary and made an educated guess as to what the passphrase was. Note that we did not really need radare2 for this (but it did make it rather nice to digest). Unix has a nice utility called <code>strings</code>, which lists <i>printable</i> ASCII strings in <i>any arbitrary file</i>.</p>

<pre>
$ strings bin/a
/lib64/ld-linux-x86-64.so.2
libc.so.6
__isoc99_scanf
puts
__cxa_finalize
strcmp
__libc_start_main
_ITM_deregisterTMCloneTable
__gmon_start__
_Jv_RegisterClasses
_ITM_registerTMCloneTable
GLIBC_2.7
GLIBC_2.2.5
=I       
=*       
AWAVA
AUATL
[]A\A]A^A_
trance
PASS
FAIL
;*3$"
GCC: (Debian 6.3.0-18) 6.3.0 20170516
crtstuff.c
__JCR_LIST__
deregister_tm_clones
__do_global_dtors_aux
completed.6963
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
__FRAME_END__
__JCR_END__
__init_array_end
_DYNAMIC
__init_array_start
__GNU_EH_FRAME_HDR
_GLOBAL_OFFSET_TABLE_
__libc_csu_fini
_ITM_deregisterTMCloneTable
puts@@GLIBC_2.2.5
_edata
__libc_start_main@@GLIBC_2.2.5
__data_start
strcmp@@GLIBC_2.2.5
__gmon_start__
__dso_handle
_IO_stdin_used
__libc_csu_init
__bss_start
main
_Jv_RegisterClasses
__isoc99_scanf@@GLIBC_2.7
__TMC_END__
_ITM_registerTMCloneTable
__cxa_finalize@@GLIBC_2.2.5
.symtab
.strtab
.shstrtab
.interp
.note.ABI-tag
.note.gnu.build-id
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.jcr
.dynamic
.got.plt
.data
.bss
.comment
</pre>

<p>While this works, it is clearly much more tedious than the method we employed earlier. The beauty of radare2 is that it is smart enough to know which strings to display and which to omit.</p>

<p>If we want an <i>even more</i> tedious method, opening the binary in a hex editor, or even just a plain text editor (or better yet, in <code>less</code>) and simply skim-reading for human-readable words would have worked (this is not for the weak-willed, though).</p>
</section>

<section id="s3">
<h2>Conclusion</h2>
<p>Crackerjack is a work in progess and I am adding new puzzles as I write and test them. I will publish a walkthrough for Puzzle B soon (Puzzle B poses more interesting challenges, but is not out of reach).</p>

<p>On a more general note, if you are looking for some excellent communities for learning and discussing reverse engineering, consider <a href="https://reddit.com/r/ReverseEngineering" target="_blank" title="Reverse Engineering">/r/ReverseEngineering</a> or <a href="https://reddit.com/r/REGames" target="_blank" title="Reverse Engineering Games">/r/REGames</a> on Reddit, or the <a href="https://reverseengineering.stackexchange.com" target="_blank" title="Reverse Engineering Stack Exchange">Reverse Engineering Stack Exchange</a>.</p>
</section>


</article>

        </div>
      </div>
    </div>
	</div>

    <hr>
<footer class="site-footer">
    <div class="container">
        <div class="row">
            <div class="col-xs-4">
                <a class="github-button" href="https://github.com/jmcph4" data-style="mega" aria-label="Follow @jmcph4 on GitHub">Follow @jmcph4</a>
            </div>
            <div class="col-xs-4">
                <p class="footer-rss">Subscribe <a href="/feed.xml">via RSS</a></p>
            </div>
            <div class="col-xs-4">
                <p class="footer-copyright">Copyright &copy; Jack McPherson 2015-2018.</p>
            </div>
        </div>
    </div>
</footer>

  </body>

</html>
